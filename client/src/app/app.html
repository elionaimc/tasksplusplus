<main class="main">
  <div class="content">
    <div class="left-side">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 2432.17 547.02"
        class="cloudplusplus-logo"
        title="Cloud Plus Plus home">
        <path d="M181.31 219.01c15.08 0 27.23 3.33 37.12 10.18 10.05 6.97 18.9 18.6 26.27 34.58l8.44 18.3 77.27-70.11-4.89-10c-12.64-25.8-31.6-46.22-56.34-60.69-24.51-14.32-52.87-21.59-84.32-21.59-26.46 0-51.32 4.69-73.91 13.9-22.85 9.35-42.75 23.32-59.12 41.51-16.21 18.03-29.07 40.7-38.22 67.36C4.57 268.81 0 299.51 0 333.7s4.58 64.81 13.63 90.94c9.13 26.36 21.69 48.83 37.34 66.79 15.87 18.21 34.87 32.18 56.49 41.54 21.43 9.32 44.85 14.05 69.59 14.05 16.96 0 32.95-2.1 47.47-6.27 14.44-4.12 27.79-9.77 39.7-16.76 11.88-6.97 22.64-15.1 31.99-24.19 9.02-8.76 17.01-17.9 23.74-27.2l7.86-10.84-73.47-65.33-9.6 13.27c-8.73 12.08-19 21.76-30.53 28.75-11.03 6.69-21.78 9.94-32.89 9.94-24.09 0-43.18-8.84-58.37-27.06-15.66-18.74-23.61-48.22-23.61-87.63s7.95-68.89 23.61-87.64c15.19-18.2 34.28-27.05 58.37-27.05ZM374.28 0h100.04v537.07H374.28zM841.29 175.18c-16.1-18.18-35.34-32.14-57.19-41.5-21.69-9.29-45.43-14-70.56-14s-49.52 4.71-71 14.03c-21.58 9.36-40.68 23.32-56.78 41.47-16.01 18.1-28.51 40.81-37.14 67.5-8.51 26.23-12.81 56.84-12.81 91.02s4.32 64.71 12.83 90.69c8.65 26.48 21.13 49.06 37.14 67.12 16.08 18.17 35.18 32.13 56.76 41.46 21.44 9.32 45.33 14.05 71 14.05s48.93-4.71 70.56-14.01c21.85-9.34 41.09-23.3 57.21-41.49 15.98-18.07 28.47-40.65 37.13-67.12 8.53-26.06 12.85-56.57 12.85-90.69s-4.32-64.7-12.83-91.01c-8.64-26.7-21.14-49.41-37.15-67.51h-.02ZM792.65 333.7c0 39.55-7.54 69.15-22.42 87.95-14.24 18-32.77 26.74-56.69 26.74s-42.29-8.73-56.3-26.67c-14.68-18.81-22.12-48.42-22.12-88.02s7.44-69.19 22.13-88.01c13.99-17.95 32.4-26.68 56.28-26.68s42.46 8.75 56.69 26.75c14.88 18.81 22.42 48.41 22.42 87.94ZM1165.49 393.31c-8.28 19.24-17.4 33.43-27.11 42.17-9.15 8.22-19.87 12.22-32.81 12.22-20.25 0-33.67-5.92-41.05-18.14-6.01-9.9-13.16-31.74-13.16-79.49V129.63H951.33v257.43c0 25.78 3.51 48.86 10.43 68.58 7.06 20.07 16.79 37.08 28.94 50.54 12.37 13.75 27.28 24.16 44.32 30.91 16.6 6.59 34.59 9.93 53.47 9.93 20 0 39.49-4.13 57.94-12.3 7.95-3.52 15.51-7.95 22.62-13.25v15.59h96.48V129.64h-100.05v263.67h.01ZM1558.97 0v142.47c-4.58-3.32-9.48-6.35-14.72-9.04-17.68-9.12-38.63-13.75-62.27-13.75s-44.59 4.81-64.11 14.29c-19.59 9.52-36.58 23.69-50.5 42.09-13.62 17.98-24.38 40.56-31.97 67.11-7.47 26.14-11.25 56.6-11.25 90.53s3.8 63.61 11.27 89.5c7.59 26.34 18.46 48.93 32.32 67.11 14.16 18.62 31.26 32.9 50.81 42.41 19.5 9.49 41.08 14.3 64.14 14.3s46.69-5.19 67.38-15.42c5.83-2.87 11.17-6 16.01-9.38v14.84H1659V0h-100.03Zm4.28 272.13v118.32c-5.89 17.88-14.74 32.5-26.34 43.51-11.26 10.68-25.26 15.86-42.84 15.86-22.59 0-39.81-8.88-52.64-27.14-13.78-19.65-20.78-49.83-20.78-89.69s7.02-71.47 20.91-90.07c13.03-17.53 31.15-26.06 55.36-26.06 14 0 26.65 4.21 38.65 12.85 11.39 8.22 20.7 22.49 27.68 42.41Z" style="fill:#3c3c3b;stroke-width:0;"></path><path d="M1936.22 118.71V.14h-83.32v118.57h-125.06v83.34h125.06v120.98h83.32V202.05h114.51v-83.34h-114.51z" style="fill:#238eab;stroke-width:0;"></path><path d="M2317.66 118.71V.14h-83.31v118.57h-125.07v83.34h125.07v120.98h83.31V202.05h114.51v-83.34h-114.51z" style="fill:#32fa64;stroke-width:0;"></path>
      </svg>
      <button mat-flat-button class="add-button" (click)="createTask()">
        <mat-icon>add</mat-icon>
        New task
      </button>
      <h1>
        My Task Manager
      </h1>
      <p>
        You can use the <em>new task</em> button above to create a new task or interact with the list to change its content.
      </p>
    </div>

    <div class="divider" aria-label="Divider"></div>
    
    <div class="right-side">
     <div>
        @for (task of taskService.tasksSignal(); track task; let idx = $index) {
          <mat-accordion style="min-width: 100%;" *ngIf="filter(idx)">
            <mat-expansion-panel (opened)="changeState(idx, true)" (closed)="changeState(idx, false)" [class]="(task.finished) ? 'mat-elevation-z finished' : 'mat-elevation-z'">
              <mat-expansion-panel-header [class]="(task.finished) ? 'finished' : ''">
                <mat-panel-title [class]="(task.finished) ? 'light-gray line-through' : 'primary bolder'"> {{ task.title }} </mat-panel-title>
                  @if(!states[idx]) {
                    @if(!isSmallScreen) {
                      <span class="gray pt-8 small">{{ task.updatedAt }} &nbsp; </span>
                      &nbsp; 
                    }
                    <button mat-icon-button (click)="editStatusTask(idx, $event)">
                      <mat-icon [class]="(task.finished) ? 'success' : 'light-gray'">done_all</mat-icon>
                    </button> &nbsp;  &nbsp;  &nbsp; 
                  }
                </mat-expansion-panel-header>
                <span [class]="(task.finished) ? 'mt-13 pl-13 light-gray' : 'mt-13 pl-13 dark-gray'">{{ task.description }}</span>
                <br/>
                @if (!task.finished) {
                  <button mat-button disabled><mat-icon>event_available</mat-icon> {{ task.createdAt }}</button>
                  <button mat-button disabled><mat-icon>edit</mat-icon> {{ task.updatedAt }}</button>
                } @else {
                  <button mat-button disabled><mat-icon>done_all</mat-icon> {{ task.updatedAt }}</button>
                }
                <mat-action-row>
                  @if (!task.finished) {
                    <button mat-icon-button (click)="editTask(task, idx)" class="dark-gray">
                      <mat-icon>edit</mat-icon>
                    </button>
                  }
                  @if(states[idx]) {
                    <button mat-icon-button (click)="editStatusTask(idx, $event)" >
                      <mat-icon [class]="(task.finished) ? 'gray' : 'dark-gray'">done_all</mat-icon>
                    </button> 
                  } 
                  <button mat-icon-button (click)="deleteTask(idx)">
                    <mat-icon [class]="(task.finished) ? 'gray' : 'danger'">delete_outline</mat-icon>
                  </button>
                </mat-action-row>
            </mat-expansion-panel>
          </mat-accordion>
        }
      </div>
    </div>

  </div>
</main>
<router-outlet />
